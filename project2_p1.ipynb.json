{
 "cells": [
  {
   "cell_type": "code",
   "execution_count": 2,
   "metadata": {},
   "outputs": [],
   "source": [
    "from bs4 import BeautifulSoup\n",
    "import requests\n",
    "import pandas as pd\n",
    "\n",
    "wc_1998 = requests.get('https://www.iwf.net/results/results-by-events/?event=96').text\n",
    "wc_1999 = requests.get('https://www.iwf.net/results/results-by-events/?event=4').text\n",
    "xxvii = requests.get('https://www.iwf.net/results/results-by-events/?event=71').text\n",
    "wc_2001 = requests.get('https://www.iwf.net/results/results-by-events/?event=89').text\n",
    "wc_2002 = requests.get('https://www.iwf.net/results/results-by-events/?event=91').text\n",
    "wc_2003 = requests.get('https://www.iwf.net/results/results-by-events/?event=94').text\n",
    "xxviii = requests.get('https://www.iwf.net/results/results-by-events/?event=4').text\n",
    "wc_2005 = requests.get('https://www.iwf.net/results/results-by-events/?event=3').text\n",
    "wc_2006 = requests.get('https://www.iwf.net/results/results-by-events/?event=8').text\n",
    "wc_2007 = requests.get('https://www.iwf.net/results/results-by-events/?event=11').text\n",
    "xxix = requests.get('https://www.iwf.net/results/results-by-events/?event=21').text\n",
    "wc_2009 = requests.get('https://www.iwf.net/results/results-by-events/?event=41').text\n",
    "wc_2010 = requests.get('https://www.iwf.net/results/results-by-events/?event=116').text\n",
    "wc_2011 = requests.get('https://www.iwf.net/results/results-by-events/?event=190').text\n",
    "xxx = requests.get('https://www.iwf.net/results/results-by-events/?event=214').text\n",
    "wc_2013 = requests.get('https://www.iwf.net/results/results-by-events/?event=253').text\n",
    "wc_2014 = requests.get('https://www.iwf.net/results/results-by-events/?event=298').text\n",
    "wc_2015 = requests.get('https://www.iwf.net/results/results-by-events/?event=341').text\n",
    "xxxi = requests.get('https://www.iwf.net/results/results-by-events/?event=362').text\n",
    "wc_2017 = requests.get('https://www.iwf.net/results/results-by-events/?event=405').text\n",
    "\n",
    "list_events = [wc_1998, wc_1999, xxvii, wc_2001, wc_2002, wc_2003, \n",
    "               xxviii, wc_2005, wc_2006, wc_2007, xxix, wc_2009, wc_2010, wc_2011, xxx, \n",
    "              wc_2013, wc_2014, wc_2015, xxxi, wc_2017]"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 31,
   "metadata": {},
   "outputs": [],
   "source": [
    "def organize(rows):\n",
    "    list_name = []\n",
    "    list_dob = []\n",
    "    list_dob_final = []\n",
    "    list_bw = []\n",
    "    list_snatch = []\n",
    "    list_cj = []\n",
    "    list_total = []\n",
    "    for row in rows:\n",
    "            cells = row.findChildren('td')\n",
    "            n = 0\n",
    "            for cell in cells:\n",
    "                n += 1\n",
    "                value = cell.string\n",
    "                if n == 2:\n",
    "                    list_name.append(value)\n",
    "                elif (n - 2) % 9 == 0:\n",
    "                    list_name.append(value)\n",
    "    for row in rows:\n",
    "            cells = row.findChildren('td')\n",
    "            n = 0\n",
    "            for cell in cells:\n",
    "                n += 1\n",
    "                value = cell.string\n",
    "                if n == 3:\n",
    "                    list_dob.append(value)\n",
    "                elif (n - 3) % 9 == 0:\n",
    "                    list_dob.append(value)\n",
    "    for row in rows:\n",
    "            cells = row.findChildren('td')\n",
    "            n = 0\n",
    "            for cell in cells:\n",
    "                n += 1\n",
    "                value = cell.string\n",
    "                if n == 5:\n",
    "                    list_bw.append(value)\n",
    "                elif (n - 5) % 9 == 0:\n",
    "                    list_bw.append(value)\n",
    "    for row in rows:\n",
    "            cells = row.findChildren('td')\n",
    "            n = 0\n",
    "            for cell in cells:\n",
    "                n += 1\n",
    "                value = cell.string\n",
    "                if n == 7:\n",
    "                    list_snatch.append(value)\n",
    "                elif (n - 7) % 9 == 0:\n",
    "                    list_snatch.append(value)\n",
    "    for row in rows:\n",
    "            cells = row.findChildren('td')\n",
    "            n = 0\n",
    "            for cell in cells:\n",
    "                n += 1\n",
    "                value = cell.string\n",
    "                if n == 8:\n",
    "                    list_cj.append(value)\n",
    "                elif (n - 8) % 9 == 0:\n",
    "                    list_cj.append(value)\n",
    "    for row in rows:\n",
    "            cells = row.findChildren('td')\n",
    "            n = 0\n",
    "            for cell in cells:\n",
    "                n += 1\n",
    "                value = cell.string\n",
    "                if n == 9:\n",
    "                    list_total.append(value)\n",
    "                elif (n - 9) % 9 == 0:\n",
    "                    list_total.append(value)\n",
    "    for i in list_dob:\n",
    "        r = list(i)\n",
    "        del r[0:6]\n",
    "        s = ''.join(r)\n",
    "        list_dob_final.append(int(s))\n",
    "    list_all = [list(l) for l in zip(list_dob_final, list_bw, list_snatch, list_cj, list_total)]\n",
    "    dict1 = dict(zip(list_name, list_all))\n",
    "    dict2 = {}\n",
    "    for key in list(dict1.keys()):\n",
    "        if dict1[key][4] == '---':\n",
    "            del dict1[key]\n",
    "    n = 0\n",
    "    for key, value in dict1.items():\n",
    "        n += 1\n",
    "        if n <= 3:\n",
    "            dict2[key] = value\n",
    "\n",
    "    return dict2"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 32,
   "metadata": {},
   "outputs": [],
   "source": [
    "def total_set(html): \n",
    "    list_tables = []\n",
    "    for i in range(0, 8):\n",
    "        table = soup.find_all('table')[i]\n",
    "        list_tables.append(table)\n",
    "        \n",
    "    dict_semi_final = {}\n",
    "    for t in list_tables:\n",
    "        rows = t.findChildren(['tr'])\n",
    "        r = organize(rows)\n",
    "        for key, value in r.items():\n",
    "            dict_semi_final[key] = value\n",
    "    return dict_semi_final"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 33,
   "metadata": {},
   "outputs": [],
   "source": [
    "n = 1997\n",
    "cols = ['DOB', 'BW', 'Snatch', 'C&J', 'Total', 'Year']\n",
    "items = []\n",
    "for html in list_events:\n",
    "    n += 1\n",
    "    soup = BeautifulSoup(html, \"html.parser\")\n",
    "    dict_here = total_set(soup)\n",
    "    for key, value in dict_here.items():\n",
    "        dict_here[key].append(int(n))\n",
    "    for key, value in dict_here.items():\n",
    "        items.append(value)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 38,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>DOB</th>\n",
       "      <th>BW</th>\n",
       "      <th>Snatch</th>\n",
       "      <th>C&amp;J</th>\n",
       "      <th>Total</th>\n",
       "      <th>Year</th>\n",
       "      <th>Age</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>1973</td>\n",
       "      <td>55.66</td>\n",
       "      <td>135</td>\n",
       "      <td>160</td>\n",
       "      <td>295</td>\n",
       "      <td>1998</td>\n",
       "      <td>25</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>1974</td>\n",
       "      <td>55.85</td>\n",
       "      <td>127.5</td>\n",
       "      <td>157.5</td>\n",
       "      <td>285</td>\n",
       "      <td>1998</td>\n",
       "      <td>24</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>1971</td>\n",
       "      <td>55.86</td>\n",
       "      <td>122.5</td>\n",
       "      <td>160</td>\n",
       "      <td>282.5</td>\n",
       "      <td>1998</td>\n",
       "      <td>27</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>1971</td>\n",
       "      <td>61.76</td>\n",
       "      <td>147.5</td>\n",
       "      <td>172.5</td>\n",
       "      <td>320</td>\n",
       "      <td>1998</td>\n",
       "      <td>27</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>1970</td>\n",
       "      <td>61.80</td>\n",
       "      <td>145</td>\n",
       "      <td>172.5</td>\n",
       "      <td>317.5</td>\n",
       "      <td>1998</td>\n",
       "      <td>28</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>...</th>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>475</th>\n",
       "      <td>1992</td>\n",
       "      <td>104.78</td>\n",
       "      <td>180</td>\n",
       "      <td>222</td>\n",
       "      <td>402</td>\n",
       "      <td>2017</td>\n",
       "      <td>25</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>476</th>\n",
       "      <td>1986</td>\n",
       "      <td>103.77</td>\n",
       "      <td>182</td>\n",
       "      <td>217</td>\n",
       "      <td>399</td>\n",
       "      <td>2017</td>\n",
       "      <td>31</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>477</th>\n",
       "      <td>1993</td>\n",
       "      <td>166.00</td>\n",
       "      <td>220</td>\n",
       "      <td>257</td>\n",
       "      <td>477</td>\n",
       "      <td>2017</td>\n",
       "      <td>24</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>478</th>\n",
       "      <td>1988</td>\n",
       "      <td>169.31</td>\n",
       "      <td>203</td>\n",
       "      <td>251</td>\n",
       "      <td>454</td>\n",
       "      <td>2017</td>\n",
       "      <td>29</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>479</th>\n",
       "      <td>1989</td>\n",
       "      <td>173.68</td>\n",
       "      <td>211</td>\n",
       "      <td>242</td>\n",
       "      <td>453</td>\n",
       "      <td>2017</td>\n",
       "      <td>28</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>480 rows Ã— 7 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "      DOB      BW Snatch    C&J  Total  Year  Age\n",
       "0    1973   55.66    135    160    295  1998   25\n",
       "1    1974   55.85  127.5  157.5    285  1998   24\n",
       "2    1971   55.86  122.5    160  282.5  1998   27\n",
       "3    1971   61.76  147.5  172.5    320  1998   27\n",
       "4    1970   61.80    145  172.5  317.5  1998   28\n",
       "..    ...     ...    ...    ...    ...   ...  ...\n",
       "475  1992  104.78    180    222    402  2017   25\n",
       "476  1986  103.77    182    217    399  2017   31\n",
       "477  1993  166.00    220    257    477  2017   24\n",
       "478  1988  169.31    203    251    454  2017   29\n",
       "479  1989  173.68    211    242    453  2017   28\n",
       "\n",
       "[480 rows x 7 columns]"
      ]
     },
     "execution_count": 38,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "df1 = pd.DataFrame(items, columns=cols)\n",
    "df1['Age'] = (df1['Year'] - df1['DOB'])\n",
    "df1"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 42,
   "metadata": {},
   "outputs": [],
   "source": [
    "df1.to_csv(r'/Users/maxgebhard/p1_df_1.csv', index = False)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {},
   "outputs": [],
   "source": []
  }
 ],
 "metadata": {
  "kernelspec": {
   "display_name": "Python 3",
   "language": "python",
   "name": "python3"
  },
  "language_info": {
   "codemirror_mode": {
    "name": "ipython",
    "version": 3
   },
   "file_extension": ".py",
   "mimetype": "text/x-python",
   "name": "python",
   "nbconvert_exporter": "python",
   "pygments_lexer": "ipython3",
   "version": "3.8.3"
  }
 },
 "nbformat": 4,
 "nbformat_minor": 4
}
